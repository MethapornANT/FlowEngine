graph TD
E_Start[เริ่ม E: POST ข้อมูลสุดท้ายเข้า WinSpeed] --> E1[เตรียมข้อมูลจากผล MAP ในขั้น D]

E1 --> E2[เรียก API POST ไปยัง WinSpeed]

E2 --> E3{POST สำเร็จไหม}

E3 -- สำเร็จ --> L_Success[บันทึก Log ว่า POST สำเร็จ]
L_Success --> E_End_OK[จบขั้นตอน E ด้วยสถานะสำเร็จ]

E3 -- ไม่สำเร็จ --> EH[ErrorHandler บันทึก Log และ ErrorCode]

EH --> R{ผลลัพธ์จาก ErrorHandler}

R -- RETRY --> E2
R -- DEAD --> DeadQ[ส่งไป DeadQueue]
DeadQ --> E_End_Fail[จบขั้นตอน E ด้วยสถานะล้มเหลว]
