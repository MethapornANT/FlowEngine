graph TD

    %% จุดเริ่มต้นของรอบการทำงาน
    A((เริ่ม)) --> B{ระบบพร้อมทำงานหรือไม่}

    %% ถ้ายังไม่พร้อม เช่น DB ล่ม, API ใช้ไม่ได้, config ไม่ครบ
    B -- ไม่พร้อม --> F((จบการทำงานรอบนี้))

    %% ถ้าพร้อม → เริ่มกระบวนการ
    B -- พร้อม --> C[ดึงข้อมูลจากระบบ CSC]

    %% ตรวจสอบว่าดึงข้อมูลได้จริงไหม
    C --> C2{ดึงข้อมูลสำเร็จหรือไม่}

    C2 -- ไม่สำเร็จ --> F
    C2 -- สำเร็จ --> D[ตรวจสอบข้อมูลและดึงข้อมูลย่อยที่จำเป็น]

    %% ขั้นตอนประมวลผลข้อมูล เช่น mapping หรือแปลงโครงสร้าง
    D --> D2{ข้อมูลครบสำหรับส่งไป WinSpeed หรือไม่}

    D2 -- ไม่ครบหรือข้อมูลผิดรูปแบบ --> F
    D2 -- ข้อมูลถูกต้อง --> E[เพิ่มข้อมูลลง WinSpeed]

    %% เพิ่มข้อมูล WinSpeed สำเร็จไหม
    E --> E2{เพิ่มข้อมูลสำเร็จหรือไม่}

    E2 -- ไม่สำเร็จ --> F
    E2 -- สำเร็จ --> G((จบรอบการทำงาน))

    %% ทุกกรณีสุดท้ายจะย้อนกลับไปรอรอบใหม่
    F --> H[รอรอบถัดไป]
    G --> H
    H --> A
