graph TD
    D_Start((เข้าสู่ D)) --> D1{ตรวจสอบชื่อลูกค้า WinSpeed มีอยู่แล้วหรือไม่?};
    
    %% 1. ตรวจสอบชื่อลูกค้า
    D1 -- มีแล้ว --> D2{ตรวจสอบชื่อผู้ติดต่อ WinSpeed มีอยู่แล้วหรือไม่?};
    
    D1 -- ไม่มี --> D3[เพิ่มชื่อลูกค้าใหม่ใน WinSpeed - ใช้ข้อมูล CSC]; 
    D3 --> D3_Log[บันทึก Log: สร้างลูกค้าใหม่]; 
    D3_Log --> D2; 
    
    %% 2. ตรวจสอบชื่อผู้ติดต่อ
    D2 -- มีแล้ว --> D4[เรียก API เพื่อสร้างรหัสเอกสารใหม่ SOID];
    
    D2 -- ไม่มี --> D5[เพิ่มชื่อผู้ติดต่อใหม่ใน WinSpeed - ใช้ข้อมูล CSC];
    D5 --> D5_Log[บันทึก Log: สร้างผู้ติดต่อใหม่];
    D5_Log --> D4; 
    
    %% 3. สิ้นสุดกระบวนการ (ออกจาก D)
    D4 --> D_End((ออกจาก D: ครบ));