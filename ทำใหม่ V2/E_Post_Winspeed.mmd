graph TD
E_Start[เริ่ม E POST ข้อมูลสุดท้าย] --> E1[เตรียมข้อมูลจากผล MAP]

E1 --> E2[เรียก API POST เข้า WinSpeed]

%% ส่งผล POST ให้ ErrorHandler ตัดสิน
E2 --> E_EH[ส่งผล POST ให้ ErrorHandler]

E_EH --> E_Result{ผลจาก ErrorHandler}

E_Result -- SUCCESS --> E_Success[LOG POST สำเร็จ]
E_Success --> E_End_OK[จบขั้นตอน E สำเร็จ]

E_Result -- RETRY --> E2

E_Result -- DEAD --> E_Dead[ส่งเข้า DeadQueue และจบ E]
E_Dead --> E_End_Fail[จบขั้นตอน E ล้มเหลว]
